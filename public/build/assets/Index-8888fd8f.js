import{a as t,u as U,b as G,r as c,j as R,F as J,H as Q,d as W}from"./app-d1dbfdab.js";import{a as q}from"./helper-a68b4be4.js";import{T as X}from"./TableLayout-db217659.js";import{E as Y}from"./ExpandedCell-08cdaf33.js";import Z from"./Filter-2218dfef.js";import $ from"./ClientRequest-ae1c9675.js";import ee from"./ExpandedComponent-ff5e9741.js";import te from"./ConfirmForm-62730512.js";import oe from"./RejectForm-9e3f7d70.js";import{C as re}from"./ClientLayout-518c343f.js";import{I as p}from"./IconButton-776622ad.js";import{E as se,D as ie}from"./Edit-f429e7e8.js";import{S as ne}from"./Stack-fbbf0c4c.js";import{C as ae,D as le,a as ce}from"./Done-620b4e8d.js";import{c as w}from"./createSvgIcon-8e57426f.js";import{r as me,U as pe}from"./styled-ea4cc06d.js";import{y as de}from"./yellow-64780034.js";import"./jsx-runtime_commonjs-proxy-b142d019.js";import"./useSlotProps-d015ad01.js";import"./TransitionGroupContext-a7327adb.js";import"./isMuiElement-4ac4aa11.js";import"./useControlled-f648ed34.js";import"./ButtonBase-58f8f612.js";import"./generateUtilityClasses-aacb770c.js";import"./AuthenticatedLayout-31b58a96.js";import"./Collapse-12d8860d.js";import"./Paper-546bbb26.js";import"./useTheme-d80e1e09.js";import"./Copyright-41d80426.js";import"./TextField-8c801748.js";import"./react-is.production.min-a192e302.js";import"./Modal-12c03e4b.js";import"./Typography-b920a7d0.js";import"./extendSxProp-026b344c.js";import"./Box-70f1a542.js";import"./CircularProgress-67ab0f62.js";import"./MenuItem-cbf24c2a.js";import"./dividerClasses-5ec07f0b.js";import"./usePreviousProps-8ac14aea.js";import"./Divider-d7232a9f.js";import"./DialogContent-df303438.js";import"./DialogTitle-fc4060ed.js";import"./Grid-52381724.js";import"./DialogActions-0070eb61.js";import"./Button-e4ddfc72.js";import"./Container-518a9f8d.js";import"./styled-1da70638.js";import"./TableHead-d61057cc.js";import"./TableCell-ee779cb9.js";import"./TableRow-467dcf0c.js";import"./KeyboardArrowRight-4fbceae4.js";import"./FilterAlt-8ce198a1.js";import"./Tabs-101e026a.js";import"./AccordionSummary-963b9755.js";import"./SelectSearch-844b9bcc.js";import"./Popper-77f43709.js";import"./createPopper-3cf4315c.js";import"./ShiftInfo-6b7aed0f.js";import"./TakeLeaveForm-197c710c.js";import"./DateRangePicker-96f94b9b.js";import"./PersianDatepicker-7bc4e7d5.js";import"./DesktopDatePicker-108dc254.js";import"./removeClass-9a525042.js";const ue=w(t("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckCircle"),fe=w(t("path",{d:"M17 12c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zm1.65 7.35L16.5 17.2V14h1v2.79l1.85 1.85-.7.71zM18 3h-3.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H6c-1.1 0-2 .9-2 2v15c0 1.1.9 2 2 2h6.11c-.59-.57-1.07-1.25-1.42-2H6V5h2v3h8V5h2v5.08c.71.1 1.38.31 2 .6V5c0-1.1-.9-2-2-2zm-6 2c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1z"}),"PendingActions"),he=({row:r})=>{switch(r.status){case"waiting":return t(fe,{sx:{color:de.A700}});case"accepted":return t(ue,{sx:{color:pe.A700}});case"canceled":case"rejected":return t(ce,{sx:{color:me.A400}})}},Ce=()=>{var b;const{post:r,setData:a,data:s,reset:d,processing:S}=U(),v=[{field:"name",headerName:"کاربر",type:"string",flex:1,sortable:!1,renderCell:({row:e})=>e.user.name},{field:"type",headerName:"نوع",type:"string",flex:.3},{field:"created_at",headerName:"تاریخ درخواست",type:"date",flex:.3,renderCell:({value:e})=>q(e)},{field:"message",headerName:"توضیحات",type:"string",sortable:!1,flex:.5,renderCell:Y},{field:"status",headerName:"وضعیت",type:"string",flex:.2,sortable:!1,disableMenu:!0,align:"center",renderCell:he},{field:"revisable_by",headerName:"بررسی کننده",type:"string",flex:.5,renderCell:({row:e})=>{var o;return(o=e.revisable_by)==null?void 0:o.name}},{field:"comment",headerName:"توضیحات برزسی کننده",type:"string",flex:.5},{field:"updated_at",headerName:"تاریخ آخرین تغییر",type:"string",flex:.4,renderCell:({value:e})=>e?q(e):null},{field:"id",headerName:"#",type:"actions",sortable:!1,flex:.2,renderCell:e=>{var n;let o=[];return e.row.status==="waiting"&&(k.user.id===e.row.user.id&&e.row.status==="waiting"&&(o.push(t(p,{title:"بروررسانی",onClick:L(e.row),color:"warning",children:t(se,{})},"edit-"+e.value)),o.push(t(p,{title:"حذف",onClick:_(e.row),color:"error",children:t(ie,{})},"cancel-"+e.value))),((n=i==null?void 0:i.filters)==null?void 0:n.type)==="revised"&&o.push(R(ne,{direction:"row",gap:1,children:[t(p,{onClick:T(e.value),color:"error",title:"رد",children:t(ae,{})}),t(p,{onClick:P(e.value),color:"success",title:"تایید",children:t(le,{})})]}))),o}}],{clientRequests:u,status:N,errors:ye,auth:k,success:F,defaultValues:i}=G().props,[j,f]=c.useState(!1),[xe,h]=c.useState(!1),[D,m]=c.useState(!1),[I,C]=c.useState(!1),[A,g]=c.useState(!1),L=e=>()=>{f(!0),z(e).finally(()=>{m(!0),f(!1)})},z=async e=>e?axios.get(route("clientRequestsApi.show",e)).then(o=>{a({...o.data.data,_method:"put"})}):null,E=()=>{d(),m(!1),h(!1)},_=e=>()=>{a({...e,_method:"delete"}),h(!0)},H=(e,o,n,K)=>W.Inertia.visit(route("client.clientRequests.index"),{only:["clientRequests","status","defaultValues"],data:{page:e,filters:o,sort:n,pageSize:K},preserveState:!0}),M=()=>r(s.id?route("client.clientRequests.update",s.id):route("client.clientRequests.store"),{onSuccess:E}),O=()=>{a({type:"takeLeave"}),m(!0)},l=()=>{d(),m(!1),C(!1),g(!1),d()},y=e=>{a(u.data.find(o=>o.id===e))},P=e=>()=>{y(e),C(!0)},T=e=>()=>{y(e),g(!0)},V=()=>{r(route("client.clientRequests.confirm",s.id),{onSuccess:l})},B=()=>{r(route("client.clientRequests.reject",s.id),{onSuccess:l})},x=(e,o)=>{a(n=>({...n,[e]:o}))};return R(J,{children:[t(Q,{title:"لیست درخواست ها"}),t(X,{defaultValues:i,success:F,status:N,reload:H,columns:v,data:u,rowHeight:100,addNew:((b=i==null?void 0:i.filters)==null?void 0:b.type)==="takeLeave",onClickAddNew:O,loading:S||j,Filter:Z,expandedKey:"requestable",ExpandedComponent:ee}),t($,{clientRequest:s,open:D,onClose:l,onSubmit:M,onChange:x}),t(te,{onConfirm:V,onClose:l,open:I,request:s}),t(oe,{onChange:x,onSubmit:B,onClose:l,open:A,request:s})]})},ge=[{title:"درخواست ها",link:null,icon:null}];Ce.layout=r=>t(re,{auth:r.props.auth,children:r,breadcrumbs:ge});export{Ce as default};
